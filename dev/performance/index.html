<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Performance tuning · QRMumps.jl</title><meta name="title" content="Performance tuning · QRMumps.jl"/><meta property="og:title" content="Performance tuning · QRMumps.jl"/><meta property="twitter:title" content="Performance tuning · QRMumps.jl"/><meta name="description" content="Documentation for QRMumps.jl."/><meta property="og:description" content="Documentation for QRMumps.jl."/><meta property="twitter:description" content="Documentation for QRMumps.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="QRMumps.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">QRMumps.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../features/">Features</a></li><li><a class="tocitem" href="../optional_features/">Optional features</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../control_parameters/">Control parameters</a></li><li><a class="tocitem" href="../information_parameters/">Information parameters</a></li><li class="is-active"><a class="tocitem" href>Performance tuning</a><ul class="internal"><li><a class="tocitem" href="#**Block-size**"><span><strong>Block size</strong></span></a></li><li><a class="tocitem" href="#**Reduction-tree-shape**"><span><strong>Reduction tree shape</strong></span></a></li><li><a class="tocitem" href="#**Ordering**"><span><strong>Ordering</strong></span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/spd/">Symmetric and positive definite linear systems</a></li><li><a class="tocitem" href="../tutorials/ls/">Least-squares problems</a></li><li><a class="tocitem" href="../tutorials/ln/">Least-norm problems</a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Performance tuning</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Performance tuning</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSmoothOptimizers/QRMumps.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSmoothOptimizers/QRMumps.jl/blob/main/docs/src/performance.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Performance-tuning"><a class="docs-heading-anchor" href="#Performance-tuning">Performance tuning</a><a id="Performance-tuning-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-tuning" title="Permalink"></a></h1><p>The performance of <strong>qr_mumps</strong> depends on a number of parameters. Default values are provided for these parameters that are expected to achieve reasonably good performance on a wide range of problems and architectures but for optimal performance these should be tuned. In this section we provide a list of these parameters and explain how do they have an effect on performance.</p><h2 id="**Block-size**"><a class="docs-heading-anchor" href="#**Block-size**"><strong>Block size</strong></a><a id="**Block-size**-1"></a><a class="docs-heading-anchor-permalink" href="#**Block-size**" title="Permalink"></a></h2><ul><li><strong>qr_mumps</strong> decomposes frontal matrices into blocks of size <em>mb × mb</em> (set through the <strong>qrm_mb</strong> control parameter); this decomposition provides an additional level of parallelism (other than that already expressed by the elimination tree) because it is possible to execute concurrently tasks that operate on different blocks. On the one hand, small values of mb provide high parallelism; on the other hand, high values of mb provide high efficiency for each task and make the tasks scheduling overhead negligible. This parameter should be, therefore, chosen as to provide the best compromise between parallelism and tasks efficiency. The optimal value depends on the size and structure of the problem, the number and features of processing units, the efficiency and scalability of BLAS operations, etc... On current CPUs block sizes of 128 or 256 achieve close to optimal task performance and good parallelism on moderately sized problems; if GPUs are used, higher block sizes (1024) provide better performance. Choosing a large <em>mb</em> value to achieve high performance on GPU devices can severely reduce parallelism and lead to CPU starvation. In this case the <em>nb</em> parameter (<strong>qrm_nb</strong>) can be used to generate additional parallelism; if this parameter is set to a submultiple of <em>mb</em>, the dynamic, hierarchical partitioning technique is used which can lead to better performance. Finally, some tasks use an internal block size; this is set by the <em>ib</em> parameter (<strong>qrm_ib</strong> which has to be a submultiple of <em>mb</em> and <em>nb</em>) and defines a compromise between efficiency of tasks and overall amount of floating point operations. Again, when GPUs are used, larger values of <em>ib</em> lead to better speed whereas on CPUs values of 32/64 provide satisfactory speed.</li></ul><h2 id="**Reduction-tree-shape**"><a class="docs-heading-anchor" href="#**Reduction-tree-shape**"><strong>Reduction tree shape</strong></a><a id="**Reduction-tree-shape**-1"></a><a class="docs-heading-anchor-permalink" href="#**Reduction-tree-shape**" title="Permalink"></a></h2><ul><li>The <em>bh</em> parameter (<strong>qrm_bh</strong>) defines the shape of the reduction tree in the QR panel reduction. A value of <span>$k$</span> means that a panel is divided in groups of size <span>$k$</span>, intra-group reduction is done with a flat tree, inter-group reduction with a binary tree. Therefore, a value of one achieves the highest parallelism because the whole panel is reduced through a binary tree. Conversely a value which is equal or higher than the number of blocks in a panel leads to lower parallelism because all the blocks in the panels are reduced one after the other; a zero or negative value sets a flat tree on all panels in all fronts of the multifrontal factorization. Nevertheless it must be noted that excessively small values of <em>bh</em> may lead to inefficient computations because of the nature of the involved tasks. A flat tree typically achieves high performance on a wide range of problems but for very overdetermined problems it may be beneficial to use hybrid trees.</li></ul><h2 id="**Ordering**"><a class="docs-heading-anchor" href="#**Ordering**"><strong>Ordering</strong></a><a id="**Ordering**-1"></a><a class="docs-heading-anchor-permalink" href="#**Ordering**" title="Permalink"></a></h2><ul><li>Fill-reducing ordering is essential to limit the fill-in produced by the factorization. This ordering (set through the <strong>qrm_ordering</strong> control parameter) is computed during the analysis phase and corresponds to a matrix permutation that defines the order in which unknowns are eliminated. The ordering will also affect the shape of the elimination tree which can be more or less balanced or deep with obvious consequences on parallelism, efficiency and, ultimately, execution time. Nested Dissection methods, such as those implemented in the Metis and SCOTCH packages, usually provide the best results and their running time may be high; local orderings such as AMD/COLAMD typically have a lower running time, which results in a faster analysis step, but lead to higher fill-in and thus higher running time and memory consumption for the factorization and the solve.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../information_parameters/">« Information parameters</a><a class="docs-footer-nextpage" href="../tutorials/spd/">Symmetric and positive definite linear systems »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Wednesday 24 April 2024 18:07">Wednesday 24 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
